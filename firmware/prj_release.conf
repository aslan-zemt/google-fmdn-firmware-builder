# Google FMDN Tracker - Ultra Low Power
# Supported: nRF52840, nRF52832
# Version 8: rotation fix (stack + retry + MAC rotation)

# ============================================
# Bluetooth - Minimal Broadcaster
# ============================================
CONFIG_BT=y
CONFIG_BT_BROADCASTER=y

# Disable unused features
CONFIG_BT_PERIPHERAL=n
CONFIG_BT_OBSERVER=n
CONFIG_BT_GATT_CLIENT=n
CONFIG_BT_SETTINGS=n

# ============================================
# Identity management for MAC rotation
# bt_id_reset() changes MAC on each entity rotation
# ============================================
CONFIG_BT_ID_MAX=2

# ============================================
# TX Power - +4 dBm (balanced range/power)
# ============================================
CONFIG_BT_CTLR_TX_PWR_PLUS_4=y

# ============================================
# Disable Serial/UART (saves ~1-5mA)
# ============================================
CONFIG_SERIAL=n
CONFIG_CONSOLE=n
CONFIG_UART_CONSOLE=n

# ============================================
# Disable Logging (saves CPU cycles)
# ============================================
CONFIG_LOG=n
# Note: PRINTK is a dependency of other modules, can't disable

# ============================================
# DC/DC Regulator - already enabled in DTS for nrf52840dk
# (regulator-initial-mode = NRF5X_REG_MODE_DCDC)
# ============================================

# ============================================
# Stack sizes (workqueue needs room for BLE ops during rotation)
# ============================================
CONFIG_MAIN_STACK_SIZE=1024
CONFIG_SYSTEM_WORKQUEUE_STACK_SIZE=2048
CONFIG_BT_RX_STACK_SIZE=1024

# ============================================
# Size Optimization
# ============================================
CONFIG_SIZE_OPTIMIZATIONS=y
CONFIG_SPEED_OPTIMIZATIONS=n

# ============================================
# Enable MPU Stack Protection (detects overflow instead of silent crash)
# ============================================
CONFIG_HW_STACK_PROTECTION=y

# ============================================
# LIBC fix for nrf-sdk
# ============================================
CONFIG_MINIMAL_LIBC=y
CONFIG_PICOLIBC=n
