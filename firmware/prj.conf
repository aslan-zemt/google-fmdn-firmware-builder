# Google FMDN Tracker - Dynamic EID (v3)
# Supported: nRF52840, nRF52832
# v3: On-device EID computation + GATT activation window

# ============================================
# Bluetooth - Broadcaster + Peripheral (for GATT)
# ============================================
CONFIG_BT=y
CONFIG_BT_BROADCASTER=y
CONFIG_BT_PERIPHERAL=y

# GATT for activation window
CONFIG_BT_GATT_DYNAMIC_DB=y

# Disable unused features
CONFIG_BT_OBSERVER=n
CONFIG_BT_GATT_CLIENT=n
CONFIG_BT_SETTINGS=n

# ============================================
# Identity management for MAC rotation
# bt_id_reset() changes MAC on each slot rotation
# ============================================
CONFIG_BT_ID_MAX=2

# ============================================
# TX Power - +4 dBm (balanced range/power)
# ============================================
CONFIG_BT_CTLR_TX_PWR_PLUS_4=y

# ============================================
# USB CDC ACM Console (debug build)
# ============================================
CONFIG_SERIAL=y
CONFIG_CONSOLE=y
CONFIG_USB_DEVICE_STACK_NEXT=y
CONFIG_UART_CONSOLE=y
CONFIG_UART_LINE_CTRL=y

# ============================================
# Logging via USB console
# ============================================
CONFIG_LOG=y
CONFIG_LOG_DEFAULT_LEVEL=3
CONFIG_LOG_BACKEND_UART=y
CONFIG_LOG_MODE_DEFERRED=y

# ============================================
# Stack sizes (larger for EC point multiply at boot)
# ============================================
CONFIG_MAIN_STACK_SIZE=4096
CONFIG_SYSTEM_WORKQUEUE_STACK_SIZE=4096
CONFIG_BT_RX_STACK_SIZE=1200

# ============================================
# Size Optimization
# ============================================
CONFIG_SIZE_OPTIMIZATIONS=y
CONFIG_SPEED_OPTIMIZATIONS=n

# ============================================
# Enable MPU Stack Protection
# ============================================
CONFIG_HW_STACK_PROTECTION=y

# ============================================
# LIBC fix for nrf-sdk
# ============================================
CONFIG_MINIMAL_LIBC=y
CONFIG_PICOLIBC=n
